@using Expoware.Ybq.Server.Resources

@section adhoc_Css {
    <link href="~/content/styles/typeahead.min.css" rel="stylesheet" type="text/css" />
}
@section adhoc_Scripts_Top {
    <script src="~/content/scripts/typeahead.bundle.min.js"></script>
}

<div class="col-xs-12 col-sm-8 col-md-6 col-xs-offset-0 col-sm-offset-2 col-md-offset-3">  
    <h2>Form Name</h2>
    <div id="sample-form-message" class="alert alert-info" style="display: none;"></div>
    <div class="margin-top-md">
        <form class="form-horizontal" id="sample-form"
              role="form" method="post"
              action="@Url.Action("form", "sample")">
            <div class="form-group has-feedback" id="sample-form-group-email">
                <div class="col-xs-12">
                    <input type="text" class="form-control text-lowercase"
                           id="email" name="email"
                           required
                           maxlength="50"
                           placeholder="@Strings_UI.Account_EnterYourEmail"
                           data-click-on-enter="#sample-form-submit-button">
                    <i class="fa fa-envelope form-control-feedback"></i>
                    <input type="hidden" id="email-id" />
                </div>
            </div>
            <div class="form-group has-feedback" id="sample-form-group-displayname">
                <div class="col-xs-12">
                    <input type="text" class="form-control"
                           id="displayname" name="displayname"
                           required
                           placeholder="@Strings_UI.Account_EnterYourName"
                           data-click-on-enter="#sample-form-submit-button">
                    <i class="fa fa-user form-control-feedback"></i>
                </div>
            </div>
            <div class="form-group has-feedback" id="sample-form-group-country">
                <div class="col-xs-12">
                    <input type="text" class="form-control"
                           id="country" name="country"
                           placeholder="Country"
                           data-click-on-enter="#sample-form-submit-button">
                    <i class="fa fa-flag form-control-feedback"></i>
                    <input type="hidden" id="countrycode" name="countrycode" />
                </div>
            </div>
            <div class="form-group" style="margin-top: 30px">
                <div class="col-xs-offset-2 col-xs-8 col-md-4 col-md-offset-4">
                    <button type="button" id="sample-form-submit-button"
                            class="btn btn-primary btn-block">
                        @Strings_Menu.Submit
                    </button>
                    <span id="sample-form-loader" 
                          class="text-danger" style="display: none;">
                        @Strings_Core.System_OperationInProgress
                    </span>
                </div>
            </div>
        </form>
    </div>
</div>

<script>
    new TypeAheadContainer({
        targetSelector: "#country",
        buddySelector: "#countrycode",
        //submitSelector: "#btn-sample-form-button",
        //postOnSelection: true,
        maxNumberOfHints: 8,
        hintUrl: Ybq.fromServer("/hint/countries?q=%QUERY")
    }).attach();
</script>

<script>
    $("#sample-form-submit-button").click(function() {
        if (Ybq.canAcceptValueOf("#sample-form",
                "email",
                function (input) { return input.length > 0 && Ybq.validateEmail(input); },
                "Invalid email") &&
            Ybq.canAcceptValueOf("#sample-form",
                "displayname",
                function(input) { return input.length > 0; },
                "Wrong display name") &&
            Ybq.canAcceptValueOf("#sample-form",
                "countrycode",
                function(input) { return input.length > 0; },
                "No country specified",
                "country")) {
            Ybq.postForm("#sample-form",
                function(data) {
                    var response = JSON.parse(data);
                    Ybq.toast("#sample-form-message", response.Message, response.Success);
                });
        } else {
            Ybq.clearFormAfterTimeout("#sample-form");
        }
    });
</script>
